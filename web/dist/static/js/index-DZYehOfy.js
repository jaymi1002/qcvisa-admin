var Ee=Object.defineProperty,Ge=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var ie=Object.getOwnPropertySymbols;var Ue=Object.prototype.hasOwnProperty,Be=Object.prototype.propertyIsEnumerable;var re=(_,p,n)=>p in _?Ee(_,p,{enumerable:!0,configurable:!0,writable:!0,value:n}):_[p]=n,k=(_,p)=>{for(var n in p||(p={}))Ue.call(p,n)&&re(_,n,p[n]);if(ie)for(var n of ie(p))Be.call(p,n)&&re(_,n,p[n]);return _},B=(_,p)=>Ge(_,Le(p));var S=(_,p,n)=>new Promise((s,m)=>{var c=g=>{try{M(n.next(g))}catch(x){m(x)}},w=g=>{try{M(n.throw(g))}catch(x){m(x)}},M=g=>g.done?s(g.value):Promise.resolve(g.value).then(c,w);M((n=n.apply(_,p)).next())});import{d as J,i as K,c as R,f as b,o as y,w as l,aH as Re,e,aB as ze,x as i,t as Y,aI as je,_ as Q,k as ue,h as V,a as P,F as H,aJ as pe,s as N,aK as me,S as ce,aL as fe,aM as _e,aN as ye,B as ge,b as $,I as ve,aO as qe,r as Ae,aP as De,aQ as xe,aR as Ve,aS as Fe,a3 as C,aT as Pe,u as we,P as Oe,M as We,aU as He,aV as Je,aW as Ke}from"./index-Bv0oRkyM.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{g as F,d as Qe,c as Xe,u as de}from"./dashboard-DvTkxz5x.js";/* empty css              */import{h as G}from"./moment-DFa0WlA5.js";import{u as ke}from"./loading-fjMHs6H4.js";import{O as Ze}from"./order-BhCZBY7o.js";/* empty css              */const he=J({__name:"banner",setup(_){const p=K(),n=R(()=>({username:p.username}));return(s,m)=>{const c=ze,w=Re,M=je;return y(),b(w,{class:"banner"},{default:l(()=>[e(w,{span:8},{default:l(()=>[e(c,{heading:5,style:{"margin-top":"0"}},{default:l(()=>[i(Y(s.$t("workplace.welcome"))+" "+Y(n.value.username),1)]),_:1})]),_:1}),e(M,{class:"panel-border"})]),_:1})}}}),et=Q(he,[["__scopeId","data-v-edf9fcb6"]]),be=_=>{switch(_){case"TODO":return"待处理";case"DOING":return"处理中";case"DONE":default:return"已完成"}},tt=[{value:"TODO",label:"待处理"},{value:"DOING",label:"处理中"},{value:"DONE",label:"已完成"}],at=J({__name:"saler-order-list",setup(_){window.moment=G;const p=K(),n=R(()=>({username:p.username})),s=R(()=>p.username),m=ue({status:"",rangeValue:[],keyword:""}),c=we();Oe();const w=V("MY"),{loading:M,setLoading:g}=ke(),x=V(),X=V(),L=V(!1),Z=V(!0),z=V(),h=V(tt),I=V(!1),r=()=>S(this,null,function*(){const o=w.value;let a=k({},m);if(a.rangeValue&&a.rangeValue.length){const[O,q]=a.rangeValue;a=B(k({},a),{startDate:O,endDate:q+86399999})}delete a.rangeValue,a.status||delete a.status,a.keyword||delete a.keyword;try{if(g(!0),o==="ALL"){const{data:O}=yield F(a);x.value=O}if(o==="MY"){const{data:O}=yield F(k({creator:n.value.username},a));x.value=O}}catch(O){}finally{g(!1)}}),t=()=>{r()};r();const u=()=>{r()},v=o=>{c.push({path:"/dashboard/order",query:{id:o.id,isView:"true"}})},U=o=>{c.push({path:"/dashboard/order",query:{id:o.id}})},T=o=>{Qe(o.id).then(()=>{r()})},ee=()=>{X.value={},L.value=!0,Z.value=!1},j=()=>{const o=z.value.getFormData();Xe(o).then(()=>{We.success("创建成功"),r()})},f=()=>S(this,null,function*(){var a;return!(yield(a=z.value)==null?void 0:a.validate())}),W=()=>{r()},te=(o,a)=>{r()},ae=()=>S(this,null,function*(){const o=w.value;let a="/api/order/export";if(o==="ALL"&&m.status&&(a+=`?status=${m.status}`),o==="MY"&&(a+=`?creator=${n.value.username}`,m.status&&(a+=`&status=${m.status}`)),m.rangeValue&&m.rangeValue.length){const[O,q]=m.rangeValue;a+=`&startDate=${O}&endDate=${q+86399999}`}if(m.keyword){const{keyword:O}=m;a+=`&keyword=${O}`}window.open(a)}),le=()=>{I.value=!0};return(o,a)=>{const O=ye,q=_e,A=fe,E=ge,Ce=ve,Ne=He,Ye=qe,Me=De,D=Ve,oe=ce,$e=xe,Ie=me,Se=pe,ne=Fe,Te=Pe;return y(),P(H,null,[e(Se,{loading:N(M),style:{width:"100%"}},{default:l(()=>[e(Ie,{class:"general-card","header-style":{paddingBottom:"0px"},"body-style":{padding:"17px 20px 21px 20px"}},{title:l(()=>a[6]||(a[6]=[i(" 订单创建 ")])),extra:l(()=>a[7]||(a[7]=[])),default:l(()=>[e(oe,{direction:"vertical",size:10,fill:""},{default:l(()=>[e(A,{justify:"space-between"},{default:l(()=>[e(A,{align:"center"},{default:l(()=>[e(q,{"model-value":w.value,"onUpdate:modelValue":a[0]||(a[0]=d=>w.value=d),type:"button",onChange:t},{default:l(()=>[e(O,{value:"ALL"},{default:l(()=>a[8]||(a[8]=[i(" 全部 ")])),_:1}),e(O,{value:"MY"},{default:l(()=>a[9]||(a[9]=[i(" 我创建的 ")])),_:1})]),_:1},8,["model-value"])]),_:1}),e(A,{align:"center"},{default:l(()=>[e(E,{type:"primary",onClick:ee},{default:l(()=>a[10]||(a[10]=[i("创建")])),_:1}),e(E,{style:{"margin-left":"12px"},onClick:ae},{default:l(()=>a[11]||(a[11]=[i("导出")])),_:1}),e(E,{style:{"margin-left":"12px"},onClick:le},{default:l(()=>a[12]||(a[12]=[i("导入")])),_:1})]),_:1})]),_:1}),e(A,{align:"center"},{default:l(()=>[a[14]||(a[14]=$("span",null,"关键字搜索：",-1)),e(Ce,{style:{width:"250px"},placeholder:"支持标题、客户、订单编码搜索",modelValue:m.keyword,"onUpdate:modelValue":a[1]||(a[1]=d=>m.keyword=d)},null,8,["modelValue"]),a[15]||(a[15]=$("span",{style:{"margin-left":"24px"}},"处理状态：",-1)),e(Ye,{placeholder:"全部",modelValue:m.status,"onUpdate:modelValue":a[2]||(a[2]=d=>m.status=d),style:{width:"100px"},"allow-clear":"",onChange:W},{default:l(()=>[(y(!0),P(H,null,Ae(h.value,d=>(y(),b(Ne,{key:d.value,value:d.value},{default:l(()=>[i(Y(d.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),a[16]||(a[16]=$("span",{style:{"margin-left":"24px"}},"登记日期：",-1)),e(Me,{"allow-clear":"",modelValue:m.rangeValue,"onUpdate:modelValue":a[3]||(a[3]=d=>m.rangeValue=d),"value-format":"timestamp",onChange:te,style:{width:"254px"}},null,8,["modelValue"]),e(E,{style:{"margin-left":"24px"},type:"primary",onClick:u},{default:l(()=>a[13]||(a[13]=[i("搜索")])),_:1})]),_:1}),e($e,{data:x.value,pagination:!0,bordered:!1,size:"small",scroll:{x:"140%"}},{columns:l(()=>[e(D,{ellipsis:"",tooltip:"",fixed:"left",width:"210",title:"订单编号","data-index":"orderCode"}),e(D,{ellipsis:"",tooltip:"",title:"标题","data-index":"title"}),e(D,{ellipsis:"",tooltip:"",title:"登记日期","data-index":"registrationDate"},{cell:l(({record:d})=>[i(Y(N(G)(d.registrationDate).format("YYYY-MM-DD")),1)]),_:1}),e(D,{ellipsis:"",tooltip:"",title:"客户名称","data-index":"customer"}),e(D,{ellipsis:"",tooltip:"",title:"办理国家","data-index":"country"}),e(D,{ellipsis:"",tooltip:"",title:"办理类型","data-index":"type"}),e(D,{ellipsis:"",tooltip:"",title:"签单金额","data-index":"orderMoney"}),e(D,{ellipsis:"",tooltip:"",title:"到账金额","data-index":"receivedMoney"}),e(D,{ellipsis:"",tooltip:"",title:"咨询老师","data-index":"creator"}),e(D,{ellipsis:"",tooltip:"",title:"办理状态","data-index":"status"},{cell:l(({record:d})=>[i(Y(N(be)(d.status)),1)]),_:1}),e(D,{ellipsis:"",tooltip:"",title:"办理人","data-index":"recipient"}),e(D,{ellipsis:"",tooltip:"",title:"操作费","data-index":"operateMoney"}),e(D,{ellipsis:"",tooltip:"",title:"登记月份","data-index":"registrationDate"},{cell:l(({record:d})=>[i(Y(N(G)(d.registrationDate).format("YYYY-MM")),1)]),_:1}),e(D,{ellipsis:"",tooltip:"",title:"备注","data-index":"comment"}),e(D,{title:"操作",width:"220",fixed:"right","data-index":"operator"},{cell:l(({record:d})=>[e(oe,null,{default:l(()=>[e(E,{type:"text",onClick:se=>v(d)},{default:l(()=>a[17]||(a[17]=[i("查看")])),_:2},1032,["onClick"]),e(E,{disabled:s.value!==d.creator,type:"text",onClick:se=>U(d)},{default:l(()=>a[18]||(a[18]=[i("编辑")])),_:2},1032,["disabled","onClick"]),e(E,{disabled:s.value!==d.creator&&N(p).role!=="admin",type:"text",status:"danger",onClick:se=>T(d)},{default:l(()=>a[19]||(a[19]=[i("删除")])),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1},8,["loading"]),e(ne,{visible:L.value,"onUpdate:visible":a[4]||(a[4]=d=>L.value=d),onOk:j,onCancel:o.handleCancel,"on-before-ok":f,width:"1000px"},{title:l(()=>a[20]||(a[20]=[i(" 创建订单 ")])),default:l(()=>[L.value?(y(),b(Ze,{key:0,ref_key:"orderRef",ref:z,isView:!1,scene:"create"},null,512)):C("",!0)]),_:1},8,["visible","onCancel"]),e(ne,{visible:I.value,"onUpdate:visible":a[5]||(a[5]=d=>I.value=d),width:"1000px",onOk:r,onCancel:r},{title:l(()=>a[21]||(a[21]=[i(" 导入订单 ")])),default:l(()=>[e(A,{justify:"center"},{default:l(()=>[I.value?(y(),b(Te,{key:0,action:"/api/order/import",name:"excel"})):C("",!0)]),_:1})]),_:1},8,["visible"])],64)}}}),lt=Q(at,[["__scopeId","data-v-e1183678"]]),ot=J({__name:"writer-order-list",setup(_){const p=K(),n=R(()=>({username:p.username}));R(()=>p.username);const s=ue({registrationValue:[],recipientValue:[],completeValue:[],keyword:""}),m=we();Oe();const c=V("DOING"),{loading:w,setLoading:M}=ke(),g=V();V(),V(!1),V(!0),V();const x=()=>S(this,null,function*(){const r=c.value;let t=k({},s);if(t.registrationValue&&t.registrationValue.length){const[u,v]=t.registrationValue;t=B(k({},t),{startDate:u,endDate:v+86399999}),delete t.registrationValue}if(t.recipientValue&&t.recipientValue.length){const[u,v]=t.recipientValue;t=B(k({},t),{recipientStartDate:u,recipientEndDate:v+86399999}),delete t.recipientValue}if(t.completeValue&&t.completeValue.length){const[u,v]=t.completeValue;t=B(k({},t),{completeStartDate:u,completeEndDate:v+86399999}),delete t.completeValue}t.keyword||delete t.keyword;try{if(M(!0),r==="TODO"){const{data:u}=yield F(k({status:"TODO"},t));g.value=u}if(r==="DOING"){const{data:u}=yield F(k({status:"DOING",recipient:n.value.username},t));g.value=u}if(r==="DONE"){const{data:u}=yield F(k({status:"DONE",recipient:n.value.username},t));g.value=u}}catch(u){}finally{M(!1)}}),X=r=>{x(),r==="TODO"&&(s.recipientValue=[],s.completeValue=[]),r==="DOING"&&(s.completeValue=[])};x();const L=r=>{m.push({path:"/dashboard/order",query:{id:r.id,isView:"true"}})},Z=r=>S(this,null,function*(){yield de(r.id,{status:"DOING"}),x()}),z=r=>S(this,null,function*(){yield de(r.id,{status:"DONE"}),x()}),h=()=>S(this,null,function*(){const r=c.value;let t="/api/order/export";if(r==="TODO"&&(t+="?status=TODO"),r==="DOING"&&(t+=`?status=DOING&recipient=${n.value.username}`),r==="DONE"&&(t+=`?status=DONE&recipient=${n.value.username}`),s.registrationValue&&s.registrationValue.length){const[u,v]=s.registrationValue;t+=`&startDate=${u}&endDate=${v+86399999}`}if(s.recipientValue&&s.recipientValue.length){const[u,v]=s.recipientValue;t+=`&recipientStartDate=${u}&recipientEndDate=${v+86399999}`}if(s.completeValue&&s.completeValue.length){const[u,v]=s.completeValue;t+=`&completeStartDate=${u}&completeEndDate=${v+86399999}`}if(s.keyword){const{keyword:u}=s;t+=`&keyword=${u}`}window.open(t)}),I=()=>{x()};return(r,t)=>{const u=ye,v=_e,U=fe,T=ge,ee=ve,j=De,f=Ve,W=ce,te=xe,ae=me,le=pe;return y(),b(le,{loading:N(w),style:{width:"100%"}},{default:l(()=>[e(ae,{class:"general-card","header-style":{paddingBottom:"0"},"body-style":{padding:"17px 20px 21px 20px"}},{title:l(()=>t[5]||(t[5]=[i(" 订单认领 ")])),extra:l(()=>t[6]||(t[6]=[])),default:l(()=>[e(W,{direction:"vertical",size:10,fill:""},{default:l(()=>[e(U,{justify:"space-between"},{default:l(()=>[e(U,{align:"center"},{default:l(()=>[e(v,{"model-value":c.value,"onUpdate:modelValue":t[0]||(t[0]=o=>c.value=o),type:"button",onChange:X},{default:l(()=>[e(u,{value:"TODO"},{default:l(()=>t[7]||(t[7]=[i(" 待认领 ")])),_:1}),e(u,{value:"DOING"},{default:l(()=>t[8]||(t[8]=[i(" 我认领的 ")])),_:1}),e(u,{value:"DONE"},{default:l(()=>t[9]||(t[9]=[i(" 已完成 ")])),_:1})]),_:1},8,["model-value"])]),_:1}),e(U,{align:"center"},{default:l(()=>[e(T,{type:"primary",style:{"margin-left":"12px"},onClick:h},{default:l(()=>t[10]||(t[10]=[i("导出")])),_:1})]),_:1})]),_:1}),e(U,{align:"center"},{default:l(()=>[t[14]||(t[14]=$("span",null,"关键字搜索：",-1)),e(ee,{style:{width:"250px"},placeholder:"支持标题、客户、订单编码搜索",modelValue:s.keyword,"onUpdate:modelValue":t[1]||(t[1]=o=>s.keyword=o)},null,8,["modelValue"]),t[15]||(t[15]=$("span",{style:{"margin-left":"24px"}},"登记日期：",-1)),e(j,{"allow-clear":"",modelValue:s.registrationValue,"onUpdate:modelValue":t[2]||(t[2]=o=>s.registrationValue=o),"value-format":"timestamp",onChange:I,style:{width:"254px"}},null,8,["modelValue"]),c.value==="DOING"||c.value==="DONE"?(y(),P(H,{key:0},[t[11]||(t[11]=$("span",{style:{"margin-left":"24px"}},"认领日期：",-1)),e(j,{"allow-clear":"",modelValue:s.recipientValue,"onUpdate:modelValue":t[3]||(t[3]=o=>s.recipientValue=o),"value-format":"timestamp",onChange:I,style:{width:"254px"}},null,8,["modelValue"])],64)):C("",!0),c.value==="DONE"?(y(),P(H,{key:1},[t[12]||(t[12]=$("span",{style:{"margin-left":"24px"}},"完成日期：",-1)),e(j,{"allow-clear":"",modelValue:s.completeValue,"onUpdate:modelValue":t[4]||(t[4]=o=>s.completeValue=o),"value-format":"timestamp",onChange:I,style:{width:"254px"}},null,8,["modelValue"])],64)):C("",!0),e(T,{style:{"margin-left":"24px"},type:"primary",onClick:x},{default:l(()=>t[13]||(t[13]=[i("搜索")])),_:1})]),_:1}),e(te,{data:g.value,pagination:!0,bordered:!1,size:"small",scroll:{x:"140%"}},{columns:l(()=>[e(f,{ellipsis:"",tooltip:"",fixed:"left",title:"订单编号","data-index":"orderCode"}),e(f,{ellipsis:"",tooltip:"",title:"标题","data-index":"title"}),c.value==="TODO"?(y(),b(f,{key:0,ellipsis:"",tooltip:"",title:"登记日期","data-index":"registrationDate"},{cell:l(({record:o})=>[i(Y(N(G)(o.registrationDate).format("YYYY-MM-DD")),1)]),_:1})):C("",!0),c.value==="DONE"?(y(),b(f,{key:1,ellipsis:"",tooltip:"",title:"完成日期","data-index":"completeDate"},{cell:l(({record:o})=>[i(Y(o.completeDate&&N(G)(o.completeDate).format("YYYY-MM-DD")),1)]),_:1})):C("",!0),c.value==="DOING"||c.value==="DONE"?(y(),b(f,{key:2,ellipsis:"",tooltip:"",title:"认领日期","data-index":"recipientDate"},{cell:l(({record:o})=>[i(Y(o.recipientDate&&N(G)(o.recipientDate).format("YYYY-MM-DD")),1)]),_:1})):C("",!0),e(f,{ellipsis:"",tooltip:"",title:"客户名称","data-index":"customer"}),e(f,{ellipsis:"",tooltip:"",title:"办理国家","data-index":"country"}),e(f,{ellipsis:"",tooltip:"",title:"办理类型","data-index":"type"}),e(f,{ellipsis:"",tooltip:"",title:"签单金额","data-index":"orderMoney"}),e(f,{ellipsis:"",tooltip:"",title:"到账金额","data-index":"receivedMoney"}),e(f,{ellipsis:"",tooltip:"",title:"咨询老师","data-index":"creator"}),e(f,{ellipsis:"",tooltip:"",title:"办理状态","data-index":"status"},{cell:l(({record:o})=>[i(Y(N(be)(o.status)),1)]),_:1}),e(f,{ellipsis:"",tooltip:"",title:"操作费","data-index":"operateMoney"}),e(f,{ellipsis:"",tooltip:"",title:"登记月份","data-index":"registrationDate"},{cell:l(({record:o})=>[i(Y(N(G)(o.registrationDate).format("YYYY-MM")),1)]),_:1}),e(f,{ellipsis:"",tooltip:"",title:"备注","data-index":"comment"}),e(f,{title:"操作",width:"220",fixed:"right","data-index":"operator"},{cell:l(({record:o})=>[e(W,null,{default:l(()=>[e(T,{type:"text",onClick:a=>L(o)},{default:l(()=>t[16]||(t[16]=[i("查看")])),_:2},1032,["onClick"]),o.status==="TODO"?(y(),b(T,{key:0,type:"text",status:"danger",onClick:a=>Z(o)},{default:l(()=>t[17]||(t[17]=[i("认领")])),_:2},1032,["onClick"])):C("",!0),o.status==="DOING"?(y(),b(T,{key:1,type:"text",status:"danger",onClick:a=>z(o)},{default:l(()=>t[18]||(t[18]=[i("完成")])),_:2},1032,["onClick"])):C("",!0)]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),nt=Q(ot,[["__scopeId","data-v-560a70ea"]]),st={class:"container"},it={class:"left-side"},rt={class:"panel"},dt={name:"Dashboard"},ut=J(B(k({},dt),{setup(_){const p=K(),n=R(()=>p.role);return(s,m)=>{const c=Ke,w=Je;return y(),P("div",st,[$("div",it,[$("div",rt,[e(et)]),e(w,{cols:24,"col-gap":16,"row-gap":16,style:{"margin-top":"16px"}},{default:l(()=>[e(c,{span:24},{default:l(()=>[n.value==="saler"||n.value==="admin"||n.value==="leader"?(y(),b(lt,{key:0})):C("",!0),n.value==="writer"||n.value==="admin"||n.value==="leader"?(y(),b(nt,{key:1})):C("",!0)]),_:1})]),_:1})])])}}})),Nt=Q(ut,[["__scopeId","data-v-3abdbcca"]]);export{Nt as default};
