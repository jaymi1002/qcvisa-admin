var Le=Object.defineProperty,Ue=Object.defineProperties;var Be=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var Re=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable;var de=(g,d,n)=>d in g?Le(g,d,{enumerable:!0,configurable:!0,writable:!0,value:n}):g[d]=n,C=(g,d)=>{for(var n in d||(d={}))Re.call(d,n)&&de(g,n,d[n]);if(re)for(var n of re(d))ze.call(d,n)&&de(g,n,d[n]);return g},z=(g,d)=>Ue(g,Be(d));var T=(g,d,n)=>new Promise((i,p)=>{var c=v=>{try{$(n.next(v))}catch(D){p(D)}},w=v=>{try{$(n.throw(v))}catch(D){p(D)}},$=v=>v.done?i(v.value):Promise.resolve(v.value).then(c,w);$((n=n.apply(g,d)).next())});import{d as Q,i as X,c as j,f as b,o as y,w as l,aH as je,e,aB as Pe,x as s,t as I,aI as qe,_ as Z,k as ue,h as V,a as H,F as K,aJ as pe,s as Y,aK as me,S as ce,aL as fe,aM as _e,aN as ye,B as ge,b as S,I as ve,aO as Ae,r as Fe,aP as De,aQ as xe,aR as Oe,aS as Ve,aT as We,a3 as N,aU as He,u as we,P as ke,M as Je,aV as Ke,aW as Qe,aX as Xe}from"./index-YA6A1ggE.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{g as W,d as Ze,c as he,u as oe}from"./dashboard-Bu1dWDyb.js";/* empty css              */import{h as L}from"./moment-DFa0WlA5.js";import{u as be}from"./loading-BhbPnT-V.js";import{O as et}from"./order-CqaAln-p.js";/* empty css              */const tt=Q({__name:"banner",setup(g){const d=X(),n=j(()=>({username:d.username}));return(i,p)=>{const c=Pe,w=je,$=qe;return y(),b(w,{class:"banner"},{default:l(()=>[e(w,{span:8},{default:l(()=>[e(c,{heading:5,style:{"margin-top":"0"}},{default:l(()=>[s(I(i.$t("workplace.welcome"))+" "+I(n.value.username),1)]),_:1})]),_:1}),e($,{class:"panel-border"})]),_:1})}}}),at=Z(tt,[["__scopeId","data-v-edf9fcb6"]]),Ce=g=>{switch(g){case"TODO":return"待处理";case"DOING":return"处理中";case"DONE":default:return"已完成"}},lt=[{value:"TODO",label:"待处理"},{value:"DOING",label:"处理中"},{value:"DONE",label:"已完成"}],ot=Q({__name:"saler-order-list",setup(g){window.moment=L;const d=X(),n=j(()=>({username:d.username})),i=j(()=>d.username),p=ue({status:"DOING",rangeValue:[],keyword:""}),c=we();ke();const w=V("MY"),{loading:$,setLoading:v}=be(),D=V(),h=V(),U=V(!1),ee=V(!0),P=V(),te=V(lt),B=V(!1),k=()=>T(this,null,function*(){const f=w.value;let a=C({},p);if(a.rangeValue&&a.rangeValue.length){const[o,M]=a.rangeValue;a=z(C({},a),{startDate:o,endDate:M+86399999})}delete a.rangeValue,a.status||delete a.status,a.keyword||delete a.keyword;try{if(v(!0),f==="ALL"){const{data:o}=yield W(a);D.value=o}if(f==="MY"){const{data:o}=yield W(C({creator:n.value.username},a));D.value=o}}catch(o){}finally{v(!1)}}),m=()=>{k()};k();const t=()=>{k()},u=f=>{c.push({path:"/dashboard/order",query:{id:f.id,isView:"true"}})},x=f=>{c.push({path:"/dashboard/order",query:{id:f.id}})},R=f=>{Ze(f.id).then(()=>{k()})},E=()=>{h.value={},U.value=!0,ee.value=!1},ae=()=>{const f=P.value.getFormData();he(f).then(()=>{Je.success("创建成功"),k()})},q=()=>T(this,null,function*(){var a;return!(yield(a=P.value)==null?void 0:a.validate())}),_=()=>{k()},A=(f,a)=>{k()},J=()=>T(this,null,function*(){const f=w.value;let a="/api/order/export";if(f==="ALL"&&p.status&&(a+=`?status=${p.status}`),f==="MY"&&(a+=`?creator=${n.value.username}`,p.status&&(a+=`&status=${p.status}`)),p.rangeValue&&p.rangeValue.length){const[o,M]=p.rangeValue;a+=`&startDate=${o}&endDate=${M+86399999}`}if(p.keyword){const{keyword:o}=p;a+=`&keyword=${o}`}window.open(a)}),le=()=>{B.value=!0};return(f,a)=>{const o=ye,M=_e,F=fe,G=ge,Ne=ve,Ye=Ke,Ie=Ae,$e=De,O=Oe,Me=Ve,ne=ce,Te=xe,Se=me,Ee=pe,se=We,Ge=He;return y(),H(K,null,[e(Ee,{loading:Y($),style:{width:"100%"}},{default:l(()=>[e(Se,{class:"general-card","header-style":{paddingBottom:"0px"},"body-style":{padding:"17px 20px 21px 20px"}},{title:l(()=>a[6]||(a[6]=[s(" 订单创建 ")])),extra:l(()=>a[7]||(a[7]=[])),default:l(()=>[e(ne,{direction:"vertical",size:10,fill:""},{default:l(()=>[e(F,{justify:"space-between"},{default:l(()=>[e(F,{align:"center"},{default:l(()=>[e(M,{"model-value":w.value,"onUpdate:modelValue":a[0]||(a[0]=r=>w.value=r),type:"button",onChange:m},{default:l(()=>[e(o,{value:"ALL"},{default:l(()=>a[8]||(a[8]=[s(" 全部 ")])),_:1}),e(o,{value:"MY"},{default:l(()=>a[9]||(a[9]=[s(" 我创建的 ")])),_:1})]),_:1},8,["model-value"])]),_:1}),e(F,{align:"center"},{default:l(()=>[e(G,{type:"primary",onClick:E},{default:l(()=>a[10]||(a[10]=[s("创建")])),_:1}),e(G,{style:{"margin-left":"12px"},onClick:J},{default:l(()=>a[11]||(a[11]=[s("导出")])),_:1}),e(G,{style:{"margin-left":"12px"},onClick:le},{default:l(()=>a[12]||(a[12]=[s("导入")])),_:1})]),_:1})]),_:1}),e(F,{align:"center"},{default:l(()=>[a[14]||(a[14]=S("span",null,"关键字搜索：",-1)),e(Ne,{style:{width:"250px"},placeholder:"支持标题、客户、订单编码搜索",modelValue:p.keyword,"onUpdate:modelValue":a[1]||(a[1]=r=>p.keyword=r)},null,8,["modelValue"]),a[15]||(a[15]=S("span",{style:{"margin-left":"24px"}},"处理状态：",-1)),e(Ie,{placeholder:"全部",modelValue:p.status,"onUpdate:modelValue":a[2]||(a[2]=r=>p.status=r),style:{width:"100px"},"allow-clear":"",onChange:_},{default:l(()=>[(y(!0),H(K,null,Fe(te.value,r=>(y(),b(Ye,{key:r.value,value:r.value},{default:l(()=>[s(I(r.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),a[16]||(a[16]=S("span",{style:{"margin-left":"24px"}},"登记日期：",-1)),e($e,{"allow-clear":"",modelValue:p.rangeValue,"onUpdate:modelValue":a[3]||(a[3]=r=>p.rangeValue=r),"value-format":"timestamp",onChange:A,style:{width:"254px"}},null,8,["modelValue"]),e(G,{style:{"margin-left":"24px"},type:"primary",onClick:t},{default:l(()=>a[13]||(a[13]=[s("搜索")])),_:1})]),_:1}),e(Te,{stripe:"",data:D.value,pagination:{"show-jumper":!0,"show-total":!0,"show-page-size":!0},bordered:!1,size:"small",scroll:{x:"140%"}},{columns:l(()=>[e(O,{ellipsis:"",tooltip:"",fixed:"left",width:"210",title:"订单编号","data-index":"orderCode"}),e(O,{ellipsis:"",tooltip:"",title:"标题","data-index":"title"}),e(O,{ellipsis:"",tooltip:"",title:"登记日期","data-index":"registrationDate"},{cell:l(({record:r})=>[s(I(Y(L)(r.registrationDate).format("YYYY-MM-DD")),1)]),_:1}),e(O,{ellipsis:"",tooltip:"",title:"客户名称","data-index":"customer"}),e(O,{ellipsis:"",tooltip:"",title:"办理国家","data-index":"country"}),e(O,{ellipsis:"",tooltip:"",title:"办理类型","data-index":"type"}),e(O,{ellipsis:"",tooltip:"",title:"签单金额","data-index":"orderMoney"}),e(O,{ellipsis:"",tooltip:"",title:"到账金额","data-index":"receivedMoney"}),e(O,{ellipsis:"",tooltip:"",title:"咨询老师","data-index":"creator"}),e(O,{ellipsis:"",tooltip:"",title:"办理状态","data-index":"status"},{cell:l(({record:r})=>[s(I(Y(Ce)(r.status)),1)]),_:1}),e(O,{ellipsis:"",tooltip:"",title:"文案老师","data-index":"recipient"}),e(O,{ellipsis:"",tooltip:"",title:"操作费","data-index":"operateMoney"}),e(O,{ellipsis:"",tooltip:"",title:"登记月份","data-index":"registrationDate"},{cell:l(({record:r})=>[s(I(Y(L)(r.registrationDate).format("YYYY-MM")),1)]),_:1}),e(O,{ellipsis:"",tooltip:"",title:"备注","data-index":"comment"}),e(O,{title:"操作",width:"220",fixed:"right","data-index":"operator"},{cell:l(({record:r})=>[e(ne,null,{default:l(()=>[e(G,{type:"text",onClick:ie=>u(r)},{default:l(()=>a[17]||(a[17]=[s("查看")])),_:2},1032,["onClick"]),e(G,{disabled:i.value!==r.creator&&Y(d).role!=="admin",type:"text",onClick:ie=>x(r)},{default:l(()=>a[18]||(a[18]=[s("编辑")])),_:2},1032,["disabled","onClick"]),e(Me,{content:"确定要删除吗？",onOk:ie=>R(r)},{default:l(()=>[e(G,{disabled:i.value!==r.creator&&Y(d).role!=="admin",type:"text",status:"danger"},{default:l(()=>a[19]||(a[19]=[s("删除")])),_:2},1032,["disabled"])]),_:2},1032,["onOk"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1},8,["loading"]),e(se,{visible:U.value,"onUpdate:visible":a[4]||(a[4]=r=>U.value=r),onOk:ae,onCancel:f.handleCancel,"on-before-ok":q,width:"1000px"},{title:l(()=>a[20]||(a[20]=[s(" 创建订单 ")])),default:l(()=>[U.value?(y(),b(et,{key:0,ref_key:"orderRef",ref:P,isView:!1,scene:"create"},null,512)):N("",!0)]),_:1},8,["visible","onCancel"]),e(se,{visible:B.value,"onUpdate:visible":a[5]||(a[5]=r=>B.value=r),width:"1000px",onOk:k,onCancel:k},{title:l(()=>a[21]||(a[21]=[s(" 导入订单 ")])),default:l(()=>[e(F,{justify:"center"},{default:l(()=>[B.value?(y(),b(Ge,{key:0,action:"/api/order/import",name:"excel"})):N("",!0)]),_:1})]),_:1},8,["visible"])],64)}}}),nt=Z(ot,[["__scopeId","data-v-7cbb69ef"]]),st=Q({__name:"writer-order-list",setup(g){const d=X(),n=j(()=>({username:d.username}));j(()=>d.username);const i=ue({registrationValue:[],recipientValue:[],completeValue:[],keyword:""}),p=we();ke();const c=V("DOING"),{loading:w,setLoading:$}=be(),v=V();V(),V(!1),V(!0),V();const D=()=>T(this,null,function*(){const m=c.value;let t=C({},i);if(t.registrationValue&&t.registrationValue.length){const[u,x]=t.registrationValue;t=z(C({},t),{startDate:u,endDate:x+86399999}),delete t.registrationValue}if(t.recipientValue&&t.recipientValue.length){const[u,x]=t.recipientValue;t=z(C({},t),{recipientStartDate:u,recipientEndDate:x+86399999}),delete t.recipientValue}if(t.completeValue&&t.completeValue.length){const[u,x]=t.completeValue;t=z(C({},t),{completeStartDate:u,completeEndDate:x+86399999}),delete t.completeValue}t.keyword||delete t.keyword;try{if($(!0),m==="TODO"){const{data:u}=yield W(C({status:"TODO"},t));v.value=u}if(m==="DOING"){const{data:u}=yield W(C({status:"DOING",recipient:n.value.username},t));v.value=u}if(m==="DONE"){const{data:u}=yield W(C({status:"DONE",recipient:n.value.username},t));v.value=u}}catch(u){}finally{$(!1)}}),h=m=>{D(),m==="TODO"&&(i.recipientValue=[],i.completeValue=[]),m==="DOING"&&(i.completeValue=[])};D();const U=m=>{p.push({path:"/dashboard/order",query:{id:m.id,isView:"true"}})},ee=m=>T(this,null,function*(){yield oe(m.id,{status:"DOING"}),D()}),P=m=>T(this,null,function*(){yield oe(m.id,{status:"DONE"}),D()}),te=m=>T(this,null,function*(){yield oe(m.id,{status:"TODO"}),D()}),B=()=>T(this,null,function*(){const m=c.value;let t="/api/order/export";if(m==="TODO"&&(t+="?status=TODO"),m==="DOING"&&(t+=`?status=DOING&recipient=${n.value.username}`),m==="DONE"&&(t+=`?status=DONE&recipient=${n.value.username}`),i.registrationValue&&i.registrationValue.length){const[u,x]=i.registrationValue;t+=`&startDate=${u}&endDate=${x+86399999}`}if(i.recipientValue&&i.recipientValue.length){const[u,x]=i.recipientValue;t+=`&recipientStartDate=${u}&recipientEndDate=${x+86399999}`}if(i.completeValue&&i.completeValue.length){const[u,x]=i.completeValue;t+=`&completeStartDate=${u}&completeEndDate=${x+86399999}`}if(i.keyword){const{keyword:u}=i;t+=`&keyword=${u}`}window.open(t)}),k=()=>{D()};return(m,t)=>{const u=ye,x=_e,R=fe,E=ge,ae=ve,q=De,_=Oe,A=Ve,J=ce,le=xe,f=me,a=pe;return y(),b(a,{loading:Y(w),style:{width:"100%"}},{default:l(()=>[e(f,{class:"general-card","header-style":{paddingBottom:"0"},"body-style":{padding:"17px 20px 21px 20px"}},{title:l(()=>t[5]||(t[5]=[s(" 订单认领 ")])),extra:l(()=>t[6]||(t[6]=[])),default:l(()=>[e(J,{direction:"vertical",size:10,fill:""},{default:l(()=>[e(R,{justify:"space-between"},{default:l(()=>[e(R,{align:"center"},{default:l(()=>[e(x,{"model-value":c.value,"onUpdate:modelValue":t[0]||(t[0]=o=>c.value=o),type:"button",onChange:h},{default:l(()=>[e(u,{value:"TODO"},{default:l(()=>t[7]||(t[7]=[s(" 待认领 ")])),_:1}),e(u,{value:"DOING"},{default:l(()=>t[8]||(t[8]=[s(" 我认领的 ")])),_:1}),e(u,{value:"DONE"},{default:l(()=>t[9]||(t[9]=[s(" 已完成 ")])),_:1})]),_:1},8,["model-value"])]),_:1}),e(R,{align:"center"},{default:l(()=>[e(E,{type:"primary",style:{"margin-left":"12px"},onClick:B},{default:l(()=>t[10]||(t[10]=[s("导出")])),_:1})]),_:1})]),_:1}),e(R,{align:"center"},{default:l(()=>[t[14]||(t[14]=S("span",null,"关键字搜索：",-1)),e(ae,{style:{width:"250px"},placeholder:"支持标题、客户、订单编码搜索",modelValue:i.keyword,"onUpdate:modelValue":t[1]||(t[1]=o=>i.keyword=o)},null,8,["modelValue"]),t[15]||(t[15]=S("span",{style:{"margin-left":"24px"}},"登记日期：",-1)),e(q,{"allow-clear":"",modelValue:i.registrationValue,"onUpdate:modelValue":t[2]||(t[2]=o=>i.registrationValue=o),"value-format":"timestamp",onChange:k,style:{width:"254px"}},null,8,["modelValue"]),c.value==="DOING"||c.value==="DONE"?(y(),H(K,{key:0},[t[11]||(t[11]=S("span",{style:{"margin-left":"24px"}},"认领日期：",-1)),e(q,{"allow-clear":"",modelValue:i.recipientValue,"onUpdate:modelValue":t[3]||(t[3]=o=>i.recipientValue=o),"value-format":"timestamp",onChange:k,style:{width:"254px"}},null,8,["modelValue"])],64)):N("",!0),c.value==="DONE"?(y(),H(K,{key:1},[t[12]||(t[12]=S("span",{style:{"margin-left":"24px"}},"完成日期：",-1)),e(q,{"allow-clear":"",modelValue:i.completeValue,"onUpdate:modelValue":t[4]||(t[4]=o=>i.completeValue=o),"value-format":"timestamp",onChange:k,style:{width:"254px"}},null,8,["modelValue"])],64)):N("",!0),e(E,{style:{"margin-left":"24px"},type:"primary",onClick:D},{default:l(()=>t[13]||(t[13]=[s("搜索")])),_:1})]),_:1}),e(le,{stripe:"",pagination:{"show-jumper":!0,"show-total":!0,"show-page-size":!0},data:v.value,bordered:!1,size:"small",scroll:{x:"140%"}},{columns:l(()=>[e(_,{ellipsis:"",tooltip:"",fixed:"left",title:"订单编号","data-index":"orderCode"}),e(_,{ellipsis:"",tooltip:"",title:"标题","data-index":"title"}),c.value==="TODO"?(y(),b(_,{key:0,ellipsis:"",tooltip:"",title:"登记日期","data-index":"registrationDate"},{cell:l(({record:o})=>[s(I(Y(L)(o.registrationDate).format("YYYY-MM-DD")),1)]),_:1})):N("",!0),c.value==="DONE"?(y(),b(_,{key:1,ellipsis:"",tooltip:"",title:"完成日期","data-index":"completeDate"},{cell:l(({record:o})=>[s(I(o.completeDate&&Y(L)(o.completeDate).format("YYYY-MM-DD")),1)]),_:1})):N("",!0),c.value==="DOING"||c.value==="DONE"?(y(),b(_,{key:2,ellipsis:"",tooltip:"",title:"认领日期","data-index":"recipientDate"},{cell:l(({record:o})=>[s(I(o.recipientDate&&Y(L)(o.recipientDate).format("YYYY-MM-DD")),1)]),_:1})):N("",!0),e(_,{ellipsis:"",tooltip:"",title:"客户名称","data-index":"customer"}),e(_,{ellipsis:"",tooltip:"",title:"办理国家","data-index":"country"}),e(_,{ellipsis:"",tooltip:"",title:"办理类型","data-index":"type"}),e(_,{ellipsis:"",tooltip:"",title:"签单金额","data-index":"orderMoney"}),e(_,{ellipsis:"",tooltip:"",title:"到账金额","data-index":"receivedMoney"}),e(_,{ellipsis:"",tooltip:"",title:"咨询老师","data-index":"creator"}),e(_,{ellipsis:"",tooltip:"",title:"办理状态","data-index":"status"},{cell:l(({record:o})=>[s(I(Y(Ce)(o.status)),1)]),_:1}),e(_,{ellipsis:"",tooltip:"",title:"操作费","data-index":"operateMoney"}),e(_,{ellipsis:"",tooltip:"",title:"登记月份","data-index":"registrationDate"},{cell:l(({record:o})=>[s(I(Y(L)(o.registrationDate).format("YYYY-MM")),1)]),_:1}),e(_,{ellipsis:"",tooltip:"",title:"备注","data-index":"comment"}),e(_,{title:"操作",width:"240",fixed:"right","data-index":"operator"},{cell:l(({record:o})=>[e(J,null,{default:l(()=>[e(E,{type:"text",onClick:M=>U(o)},{default:l(()=>t[16]||(t[16]=[s("查看")])),_:2},1032,["onClick"]),o.status==="TODO"?(y(),b(A,{key:0,content:"确定要认领此单吗？",onOk:M=>ee(o)},{default:l(()=>[e(E,{type:"text",status:"primary"},{default:l(()=>t[17]||(t[17]=[s("认领")])),_:1})]),_:2},1032,["onOk"])):N("",!0),o.status==="DOING"?(y(),b(A,{key:1,content:"确定要撤销吗？",onOk:M=>te(o)},{default:l(()=>[e(E,{type:"text"},{default:l(()=>t[18]||(t[18]=[s("撤销认领")])),_:1})]),_:2},1032,["onOk"])):N("",!0),o.status==="DOING"?(y(),b(A,{key:2,content:"确定要完成此单吗？",onOk:M=>P(o)},{default:l(()=>[e(E,{type:"text",status:"primary"},{default:l(()=>t[19]||(t[19]=[s("完成")])),_:1})]),_:2},1032,["onOk"])):N("",!0)]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),it=Z(st,[["__scopeId","data-v-5721ea4e"]]),rt={class:"container"},dt={class:"left-side"},ut={class:"panel"},pt={name:"Dashboard"},mt=Q(z(C({},pt),{setup(g){const d=X(),n=j(()=>d.role);return(i,p)=>{const c=Xe,w=Qe;return y(),H("div",rt,[S("div",dt,[S("div",ut,[e(at)]),e(w,{cols:24,"col-gap":16,"row-gap":16,style:{"margin-top":"16px"}},{default:l(()=>[e(c,{span:24},{default:l(()=>[n.value==="saler"||n.value==="admin"||n.value==="leader"?(y(),b(nt,{key:0})):N("",!0),n.value==="writer"||n.value==="admin"||n.value==="leader"?(y(),b(it,{key:1})):N("",!0)]),_:1})]),_:1})])])}}})),It=Z(mt,[["__scopeId","data-v-3abdbcca"]]);export{It as default};
