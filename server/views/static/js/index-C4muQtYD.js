var kt=Object.defineProperty,Ct=Object.defineProperties;var Yt=Object.getOwnPropertyDescriptors;var tt=Object.getOwnPropertySymbols;var Mt=Object.prototype.hasOwnProperty,Nt=Object.prototype.propertyIsEnumerable;var et=(c,n,o)=>n in c?kt(c,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):c[n]=o,J=(c,n)=>{for(var o in n||(n={}))Mt.call(n,o)&&et(c,o,n[o]);if(tt)for(var o of tt(n))Nt.call(n,o)&&et(c,o,n[o]);return c},at=(c,n)=>Ct(c,Yt(n));var N=(c,n,o)=>new Promise((C,i)=>{var b=f=>{try{g(o.next(f))}catch(w){i(w)}},_=f=>{try{g(o.throw(f))}catch(w){i(w)}},g=f=>f.done?C(f.value):Promise.resolve(f.value).then(b,_);g((o=o.apply(c,n)).next())});import{d as E,i as R,c as $,f as D,o as x,w as e,aH as It,e as t,aB as Lt,x as l,t as O,aI as St,_ as U,k as $t,h as y,a as K,F as ot,aJ as lt,s as k,aK as nt,S as it,aL as rt,b as Q,aM as dt,aN as ut,aO as Vt,r as Gt,B as pt,aP as ct,aQ as _t,aR as Tt,a3 as M,u as mt,P as ft,M as Bt,aS as Et,aT as Rt,aU as Ut}from"./index-OpW0-wjz.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{h as I}from"./moment-DFa0WlA5.js";import{u as vt}from"./loading-C672Cg_a.js";import{g as T,d as ht,c as zt,u as st}from"./index--anftgV6.js";import{O as qt}from"./order-B_mBlsL3.js";/* empty css              *//* empty css              */const At=E({__name:"banner",setup(c){const n=R(),o=$(()=>({username:n.username}));return(C,i)=>{const b=Lt,_=It,g=St;return x(),D(_,{class:"banner"},{default:e(()=>[t(_,{span:8},{default:e(()=>[t(b,{heading:5,style:{"margin-top":"0"}},{default:e(()=>[l(O(C.$t("workplace.welcome"))+" "+O(o.value.username),1)]),_:1})]),_:1}),t(g,{class:"panel-border"})]),_:1})}}}),Ft=U(At,[["__scopeId","data-v-edf9fcb6"]]),xt=c=>{switch(c){case"TODO":return"待处理";case"DOING":return"处理中";case"DONE":default:return"已完成"}},jt=[{value:"TODO",label:"待处理"},{value:"DOING",label:"处理中"},{value:"DONE",label:"已完成"}],Pt=E({__name:"saler-order-list",setup(c){window.moment=I;const n=R(),o=$(()=>({username:n.username})),C=$(()=>n.username),i=$t({status:""}),b=mt();ft();const _=y("MY"),{loading:g,setLoading:f}=vt(),w=y(),h=y(),L=y(!1),z=y(!0),m=y(),s=y(jt),Y=(W,...yt)=>N(this,[W,...yt],function*(d,a={}){try{if(f(!0),d==="ALL"){const{data:S}=yield T(a);w.value=S,console.log(w.value)}if(d==="MY"){const{data:S}=yield T(J({creator:o.value.username},a));w.value=S}}catch(S){}finally{f(!1)}}),q=d=>{Y(d)};Y(_.value);const A=d=>{b.push({path:"/dashboard/order",query:{id:d.id,isView:"true"}})},p=d=>{b.push({path:"/dashboard/order",query:{id:d.id}})},V=d=>{ht(d.id).then(()=>{Y(_.value)})},B=()=>{h.value={},L.value=!0,z.value=!1},F=()=>{const d=m.value.getFormData();zt(d).then(()=>{Bt.success("创建成功"),Y(_.value)})},j=()=>N(this,null,function*(){var a;return!(yield(a=m.value)==null?void 0:a.validate())}),P=()=>{Y(_.value,i.status?i:void 0)},r=()=>N(this,null,function*(){const d=_.value;i.status;let a="/api/order/export";d==="ALL"&&i.status&&(a+=`?status=${i.status}`),d==="MY"&&(a+=`?creator=${o.value.username}`,i.status&&(a+=`&status=${i.status}`)),window.open(a)});return(d,a)=>{const W=ut,yt=dt,S=Et,gt=Vt,H=rt,G=pt,v=_t,X=it,Dt=ct,Ot=nt,bt=lt,wt=Tt;return x(),K(ot,null,[t(bt,{loading:k(g),style:{width:"100%"}},{default:e(()=>[t(Ot,{class:"general-card","header-style":{paddingBottom:"0px"},"body-style":{padding:"17px 20px 21px 20px"}},{title:e(()=>a[3]||(a[3]=[l(" 订单创建 ")])),extra:e(()=>a[4]||(a[4]=[])),default:e(()=>[t(X,{direction:"vertical",size:10,fill:""},{default:e(()=>[t(H,{justify:"space-between"},{default:e(()=>[t(H,{align:"center"},{default:e(()=>[t(yt,{"model-value":_.value,"onUpdate:modelValue":a[0]||(a[0]=u=>_.value=u),type:"button",onChange:q},{default:e(()=>[t(W,{value:"ALL"},{default:e(()=>a[5]||(a[5]=[l(" 全部 ")])),_:1}),t(W,{value:"MY"},{default:e(()=>a[6]||(a[6]=[l(" 我创建的 ")])),_:1})]),_:1},8,["model-value"]),a[7]||(a[7]=Q("span",{style:{"margin-left":"24px"}},"处理状态：",-1)),t(gt,{placeholder:"全部",modelValue:i.status,"onUpdate:modelValue":a[1]||(a[1]=u=>i.status=u),style:{width:"100px"},"allow-clear":"",onChange:P},{default:e(()=>[(x(!0),K(ot,null,Gt(s.value,u=>(x(),D(S,{key:u.value,value:u.value},{default:e(()=>[l(O(u.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(H,{align:"center"},{default:e(()=>[t(G,{type:"primary",onClick:B},{default:e(()=>a[8]||(a[8]=[l("创建")])),_:1}),t(G,{style:{"margin-left":"12px"},onClick:r},{default:e(()=>a[9]||(a[9]=[l("导出")])),_:1})]),_:1})]),_:1}),t(Dt,{data:w.value,pagination:!0,bordered:!1,size:"small",scroll:{x:"140%"}},{columns:e(()=>[t(v,{ellipsis:"",tooltip:"",fixed:"left",title:"订单编号","data-index":"orderCode"}),t(v,{ellipsis:"",tooltip:"",title:"标题","data-index":"title"}),t(v,{ellipsis:"",tooltip:"",title:"登记日期","data-index":"registrationDate"},{cell:e(({record:u})=>[l(O(k(I)(u.registrationDate).format("YYYY-MM-DD")),1)]),_:1}),t(v,{ellipsis:"",tooltip:"",title:"客户名称","data-index":"customer"}),t(v,{ellipsis:"",tooltip:"",title:"办理国家","data-index":"country"}),t(v,{ellipsis:"",tooltip:"",title:"办理类型","data-index":"type"}),t(v,{ellipsis:"",tooltip:"",title:"签单金额","data-index":"orderMoney"}),t(v,{ellipsis:"",tooltip:"",title:"到账金额","data-index":"receivedMoney"}),t(v,{ellipsis:"",tooltip:"",title:"咨询老师","data-index":"creator"}),t(v,{ellipsis:"",tooltip:"",title:"办理状态","data-index":"status"},{cell:e(({record:u})=>[l(O(k(xt)(u.status)),1)]),_:1}),t(v,{ellipsis:"",tooltip:"",title:"办理人","data-index":"recipient"}),t(v,{ellipsis:"",tooltip:"",title:"操作费","data-index":"operateMoney"}),t(v,{ellipsis:"",tooltip:"",title:"登记月份","data-index":"registrationDate"},{cell:e(({record:u})=>[l(O(k(I)(u.registrationDate).format("YYYY-MM")),1)]),_:1}),t(v,{ellipsis:"",tooltip:"",title:"备注","data-index":"comment"}),t(v,{title:"操作",width:"220",fixed:"right","data-index":"operator"},{cell:e(({record:u})=>[t(X,null,{default:e(()=>[t(G,{type:"text",onClick:Z=>A(u)},{default:e(()=>a[10]||(a[10]=[l("查看")])),_:2},1032,["onClick"]),t(G,{disabled:C.value!==u.creator,type:"text",onClick:Z=>p(u)},{default:e(()=>a[11]||(a[11]=[l("编辑")])),_:2},1032,["disabled","onClick"]),t(G,{disabled:C.value!==u.creator,type:"text",status:"danger",onClick:Z=>V(u)},{default:e(()=>a[12]||(a[12]=[l("删除")])),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1},8,["loading"]),t(wt,{visible:L.value,"onUpdate:visible":a[2]||(a[2]=u=>L.value=u),onOk:F,onCancel:d.handleCancel,"on-before-ok":j,width:"1000px"},{title:e(()=>a[13]||(a[13]=[l(" 创建订单 ")])),default:e(()=>[L.value?(x(),D(qt,{key:0,ref_key:"orderRef",ref:m,isView:!1,scene:"create"},null,512)):M("",!0)]),_:1},8,["visible","onCancel"])],64)}}}),Ht=U(Pt,[["__scopeId","data-v-137f2c81"]]),Jt=E({__name:"writer-order-list",setup(c){const n=R(),o=$(()=>({username:n.username}));$(()=>n.username);const C=mt();ft();const i=y("DOING"),{loading:b,setLoading:_}=vt(),g=y();y(),y(!1),y(!0),y();const f=m=>N(this,null,function*(){try{if(_(!0),m==="TODO"){const{data:s}=yield T({status:"TODO"});g.value=s}if(m==="DOING"){const{data:s}=yield T({status:"DOING",recipient:o.value.username});g.value=s}if(m==="DONE"){const{data:s}=yield T({status:"DONE",recipient:o.value.username});g.value=s}}catch(s){}finally{_(!1)}}),w=m=>{f(m)};f(i.value);const h=m=>{C.push({path:"/dashboard/order",query:{id:m.id,isView:"true"}})},L=m=>N(this,null,function*(){yield st(m.id,{status:"DOING"}),f(i.value)}),z=m=>N(this,null,function*(){yield st(m.id,{status:"DONE"}),f(i.value)});return(m,s)=>{const Y=ut,q=dt,A=rt,p=_t,V=pt,B=it,F=ct,j=nt,P=lt;return x(),D(P,{loading:k(b),style:{width:"100%"}},{default:e(()=>[t(j,{class:"general-card","header-style":{paddingBottom:"0"},"body-style":{padding:"17px 20px 21px 20px"}},{title:e(()=>s[1]||(s[1]=[l(" 订单认领 ")])),extra:e(()=>s[2]||(s[2]=[])),default:e(()=>[t(B,{direction:"vertical",size:10,fill:""},{default:e(()=>[t(A,{justify:"space-between"},{default:e(()=>[t(q,{"model-value":i.value,"onUpdate:modelValue":s[0]||(s[0]=r=>i.value=r),type:"button",onChange:w},{default:e(()=>[t(Y,{value:"TODO"},{default:e(()=>s[3]||(s[3]=[l(" 待认领 ")])),_:1}),t(Y,{value:"DOING"},{default:e(()=>s[4]||(s[4]=[l(" 我认领的 ")])),_:1}),t(Y,{value:"DONE"},{default:e(()=>s[5]||(s[5]=[l(" 已完成 ")])),_:1})]),_:1},8,["model-value"])]),_:1}),t(F,{data:g.value,pagination:!0,bordered:!1,size:"small",scroll:{x:"140%"}},{columns:e(()=>[t(p,{ellipsis:"",tooltip:"",fixed:"left",title:"订单编号","data-index":"orderCode"}),t(p,{ellipsis:"",tooltip:"",title:"标题","data-index":"title"}),i.value==="TODO"?(x(),D(p,{key:0,ellipsis:"",tooltip:"",title:"登记日期","data-index":"registrationDate"},{cell:e(({record:r})=>[l(O(k(I)(r.registrationDate).format("YYYY-MM-DD")),1)]),_:1})):M("",!0),i.value==="DOING"?(x(),D(p,{key:1,ellipsis:"",tooltip:"",title:"认领日期","data-index":"recipientDate"},{cell:e(({record:r})=>[l(O(r.recipientDate&&k(I)(r.recipientDate).format("YYYY-MM-DD")),1)]),_:1})):M("",!0),i.value==="DONE"?(x(),D(p,{key:2,ellipsis:"",tooltip:"",title:"认领日期","data-index":"completeDate"},{cell:e(({record:r})=>[l(O(r.completeDate&&k(I)(r.completeDate).format("YYYY-MM-DD")),1)]),_:1})):M("",!0),t(p,{ellipsis:"",tooltip:"",title:"客户名称","data-index":"customer"}),t(p,{ellipsis:"",tooltip:"",title:"办理国家","data-index":"country"}),t(p,{ellipsis:"",tooltip:"",title:"办理类型","data-index":"type"}),t(p,{ellipsis:"",tooltip:"",title:"签单金额","data-index":"orderMoney"}),t(p,{ellipsis:"",tooltip:"",title:"到账金额","data-index":"receivedMoney"}),t(p,{ellipsis:"",tooltip:"",title:"咨询老师","data-index":"creator"}),t(p,{ellipsis:"",tooltip:"",title:"办理状态","data-index":"status"},{cell:e(({record:r})=>[l(O(k(xt)(r.status)),1)]),_:1}),t(p,{ellipsis:"",tooltip:"",title:"操作费","data-index":"operateMoney"}),t(p,{ellipsis:"",tooltip:"",title:"登记月份","data-index":"registrationDate"},{cell:e(({record:r})=>[l(O(k(I)(r.registrationDate).format("YYYY-MM")),1)]),_:1}),t(p,{ellipsis:"",tooltip:"",title:"备注","data-index":"comment"}),t(p,{title:"操作",width:"220",fixed:"right","data-index":"operator"},{cell:e(({record:r})=>[t(B,null,{default:e(()=>[t(V,{type:"text",onClick:d=>h(r)},{default:e(()=>s[6]||(s[6]=[l("查看")])),_:2},1032,["onClick"]),r.status==="TODO"?(x(),D(V,{key:0,type:"text",status:"danger",onClick:d=>L(r)},{default:e(()=>s[7]||(s[7]=[l("认领")])),_:2},1032,["onClick"])):M("",!0),r.status==="DOING"?(x(),D(V,{key:1,type:"text",status:"danger",onClick:d=>z(r)},{default:e(()=>s[8]||(s[8]=[l("完成")])),_:2},1032,["onClick"])):M("",!0)]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),Kt=U(Jt,[["__scopeId","data-v-9b8d227e"]]),Qt={class:"container"},Wt={class:"left-side"},Xt={class:"panel"},Zt={name:"Dashboard"},te=E(at(J({},Zt),{setup(c){const n=R(),o=$(()=>n.role);return(C,i)=>{const b=Ut,_=Rt;return x(),K("div",Qt,[Q("div",Wt,[Q("div",Xt,[t(Ft)]),t(_,{cols:24,"col-gap":16,"row-gap":16,style:{"margin-top":"16px"}},{default:e(()=>[t(b,{span:24},{default:e(()=>[o.value==="saler"||o.value==="admin"?(x(),D(Ht,{key:0})):M("",!0),o.value==="writer"||o.value==="admin"?(x(),D(Kt,{key:1})):M("",!0)]),_:1})]),_:1})])])}}})),xe=U(te,[["__scopeId","data-v-f5b8c92f"]]);export{xe as default};
