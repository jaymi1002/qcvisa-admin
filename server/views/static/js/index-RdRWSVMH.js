var Ye=Object.defineProperty,Me=Object.defineProperties;var $e=Object.getOwnPropertyDescriptors;var oe=Object.getOwnPropertySymbols;var Ie=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable;var ie=(g,r,n)=>r in g?Ye(g,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):g[r]=n,b=(g,r)=>{for(var n in r||(r={}))Ie.call(r,n)&&ie(g,n,r[n]);if(oe)for(var n of oe(r))Se.call(r,n)&&ie(g,n,r[n]);return g},R=(g,r)=>Me(g,$e(r));var S=(g,r,n)=>new Promise((i,m)=>{var d=x=>{try{N(n.next(x))}catch(O){m(O)}},v=x=>{try{N(n.throw(x))}catch(O){m(O)}},N=x=>x.done?i(x.value):Promise.resolve(x.value).then(d,v);N((n=n.apply(g,r)).next())});import{d as J,i as K,c as h,f as k,o as D,w as a,aH as Ee,e,aB as Ge,x as s,t as C,aI as Le,_ as Q,k as re,h as w,a as P,F as H,aJ as ue,s as $,aK as de,S as pe,aL as ce,b as G,aM as me,aN as fe,aO as Te,r as Be,aP as _e,B as ge,aQ as ve,aR as De,aS as Ue,a3 as M,u as xe,P as ye,M as Re,aT as he,aU as ze,aV as qe}from"./index-SR1V_CVP.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{g as F,d as Ae,c as Fe,u as se}from"./dashboard-BrI4Y7Zs.js";/* empty css              */import{h as E}from"./moment-DFa0WlA5.js";import{u as Ve}from"./loading-BPLpsJwQ.js";import{O as Pe}from"./order-B_wmiCPG.js";/* empty css              */const je=J({__name:"banner",setup(g){const r=K(),n=h(()=>({username:r.username}));return(i,m)=>{const d=Ge,v=Ee,N=Le;return D(),k(v,{class:"banner"},{default:a(()=>[e(v,{span:8},{default:a(()=>[e(d,{heading:5,style:{"margin-top":"0"}},{default:a(()=>[s(C(i.$t("workplace.welcome"))+" "+C(n.value.username),1)]),_:1})]),_:1}),e(N,{class:"panel-border"})]),_:1})}}}),He=Q(je,[["__scopeId","data-v-edf9fcb6"]]),Oe=g=>{switch(g){case"TODO":return"待处理";case"DOING":return"处理中";case"DONE":default:return"已完成"}},Je=[{value:"TODO",label:"待处理"},{value:"DOING",label:"处理中"},{value:"DONE",label:"已完成"}],Ke=J({__name:"saler-order-list",setup(g){window.moment=E;const r=K(),n=h(()=>({username:r.username})),i=h(()=>r.username),m=re({status:"",rangeValue:[]}),d=xe();ye();const v=w("MY"),{loading:N,setLoading:x}=Ve(),O=w(),W=w(),L=w(!1),X=w(!0),z=w(),Z=w(Je),Y=(o,...U)=>S(this,[o,...U],function*(c,l={}){if(l.rangeValue&&l.rangeValue.length){const[I,te]=l.rangeValue;l=R(b({},l),{startDate:I,endDate:te+86399999})}delete l.rangeValue,l.status||delete l.status;try{if(x(!0),c==="ALL"){const{data:I}=yield F(l);O.value=I}if(c==="MY"){const{data:I}=yield F(b({creator:n.value.username},l));O.value=I}}catch(I){}finally{x(!1)}}),f=c=>{Y(c)};Y(v.value);const t=c=>{d.push({path:"/dashboard/order",query:{id:c.id,isView:"true"}})},u=c=>{d.push({path:"/dashboard/order",query:{id:c.id}})},y=c=>{Ae(c.id).then(()=>{Y(v.value)})},T=()=>{W.value={},L.value=!0,X.value=!1},B=()=>{const c=z.value.getFormData();Fe(c).then(()=>{Re.success("创建成功"),Y(v.value)})},q=()=>S(this,null,function*(){var l;return!(yield(l=z.value)==null?void 0:l.validate())}),_=()=>{Y(v.value,m)},j=(c,l)=>{Y(v.value,m)},ee=()=>S(this,null,function*(){const c=v.value;let l="/api/order/export";if(c==="ALL"&&m.status&&(l+=`?status=${m.status}`),c==="MY"&&(l+=`?creator=${n.value.username}`,m.status&&(l+=`&status=${m.status}`)),m.rangeValue&&m.rangeValue.length){const[o,U]=m.rangeValue;l+=`&startDate=${o}&endDate=${U+86399999}`}window.open(l)});return(c,l)=>{const o=fe,U=me,I=he,te=Te,we=_e,ae=ce,A=ge,V=De,le=pe,be=ve,ke=de,Ce=ue,Ne=Ue;return D(),P(H,null,[e(Ce,{loading:$(N),style:{width:"100%"}},{default:a(()=>[e(ke,{class:"general-card","header-style":{paddingBottom:"0px"},"body-style":{padding:"17px 20px 21px 20px"}},{title:a(()=>l[4]||(l[4]=[s(" 订单创建 ")])),extra:a(()=>l[5]||(l[5]=[])),default:a(()=>[e(le,{direction:"vertical",size:10,fill:""},{default:a(()=>[e(ae,{justify:"space-between"},{default:a(()=>[e(ae,{align:"center"},{default:a(()=>[e(U,{"model-value":v.value,"onUpdate:modelValue":l[0]||(l[0]=p=>v.value=p),type:"button",onChange:f},{default:a(()=>[e(o,{value:"ALL"},{default:a(()=>l[6]||(l[6]=[s(" 全部 ")])),_:1}),e(o,{value:"MY"},{default:a(()=>l[7]||(l[7]=[s(" 我创建的 ")])),_:1})]),_:1},8,["model-value"]),l[8]||(l[8]=G("span",{style:{"margin-left":"24px"}},"处理状态：",-1)),e(te,{placeholder:"全部",modelValue:m.status,"onUpdate:modelValue":l[1]||(l[1]=p=>m.status=p),style:{width:"100px"},"allow-clear":"",onChange:_},{default:a(()=>[(D(!0),P(H,null,Be(Z.value,p=>(D(),k(I,{key:p.value,value:p.value},{default:a(()=>[s(C(p.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),l[9]||(l[9]=G("span",{style:{"margin-left":"24px"}},"登记日期：",-1)),e(we,{"allow-clear":"",modelValue:m.rangeValue,"onUpdate:modelValue":l[2]||(l[2]=p=>m.rangeValue=p),"value-format":"timestamp",onChange:j,style:{width:"254px"}},null,8,["modelValue"])]),_:1}),e(ae,{align:"center"},{default:a(()=>[e(A,{type:"primary",onClick:T},{default:a(()=>l[10]||(l[10]=[s("创建")])),_:1}),e(A,{style:{"margin-left":"12px"},onClick:ee},{default:a(()=>l[11]||(l[11]=[s("导出")])),_:1})]),_:1})]),_:1}),e(be,{data:O.value,pagination:!0,bordered:!1,size:"small",scroll:{x:"140%"}},{columns:a(()=>[e(V,{ellipsis:"",tooltip:"",fixed:"left",title:"订单编号","data-index":"orderCode"}),e(V,{ellipsis:"",tooltip:"",title:"标题","data-index":"title"}),e(V,{ellipsis:"",tooltip:"",title:"登记日期","data-index":"registrationDate"},{cell:a(({record:p})=>[s(C($(E)(p.registrationDate).format("YYYY-MM-DD")),1)]),_:1}),e(V,{ellipsis:"",tooltip:"",title:"客户名称","data-index":"customer"}),e(V,{ellipsis:"",tooltip:"",title:"办理国家","data-index":"country"}),e(V,{ellipsis:"",tooltip:"",title:"办理类型","data-index":"type"}),e(V,{ellipsis:"",tooltip:"",title:"签单金额","data-index":"orderMoney"}),e(V,{ellipsis:"",tooltip:"",title:"到账金额","data-index":"receivedMoney"}),e(V,{ellipsis:"",tooltip:"",title:"咨询老师","data-index":"creator"}),e(V,{ellipsis:"",tooltip:"",title:"办理状态","data-index":"status"},{cell:a(({record:p})=>[s(C($(Oe)(p.status)),1)]),_:1}),e(V,{ellipsis:"",tooltip:"",title:"办理人","data-index":"recipient"}),e(V,{ellipsis:"",tooltip:"",title:"操作费","data-index":"operateMoney"}),e(V,{ellipsis:"",tooltip:"",title:"登记月份","data-index":"registrationDate"},{cell:a(({record:p})=>[s(C($(E)(p.registrationDate).format("YYYY-MM")),1)]),_:1}),e(V,{ellipsis:"",tooltip:"",title:"备注","data-index":"comment"}),e(V,{title:"操作",width:"220",fixed:"right","data-index":"operator"},{cell:a(({record:p})=>[e(le,null,{default:a(()=>[e(A,{type:"text",onClick:ne=>t(p)},{default:a(()=>l[12]||(l[12]=[s("查看")])),_:2},1032,["onClick"]),e(A,{disabled:i.value!==p.creator,type:"text",onClick:ne=>u(p)},{default:a(()=>l[13]||(l[13]=[s("编辑")])),_:2},1032,["disabled","onClick"]),e(A,{disabled:i.value!==p.creator,type:"text",status:"danger",onClick:ne=>y(p)},{default:a(()=>l[14]||(l[14]=[s("删除")])),_:2},1032,["disabled","onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1},8,["loading"]),e(Ne,{visible:L.value,"onUpdate:visible":l[3]||(l[3]=p=>L.value=p),onOk:B,onCancel:c.handleCancel,"on-before-ok":q,width:"1000px"},{title:a(()=>l[15]||(l[15]=[s(" 创建订单 ")])),default:a(()=>[L.value?(D(),k(Pe,{key:0,ref_key:"orderRef",ref:z,isView:!1,scene:"create"},null,512)):M("",!0)]),_:1},8,["visible","onCancel"])],64)}}}),Qe=Q(Ke,[["__scopeId","data-v-89a76451"]]),We=J({__name:"writer-order-list",setup(g){const r=K(),n=h(()=>({username:r.username}));h(()=>r.username);const i=re({registrationValue:[],recipientValue:[],completeValue:[]}),m=xe();ye();const d=w("DOING"),{loading:v,setLoading:N}=Ve(),x=w();w(),w(!1),w(!0),w();const O=f=>S(this,null,function*(){let t=b({},i);if(t.registrationValue&&t.registrationValue.length){const[u,y]=t.registrationValue;t=R(b({},t),{startDate:u,endDate:y+86399999}),delete t.registrationValue}if(t.recipientValue&&t.recipientValue.length){const[u,y]=t.recipientValue;t=R(b({},t),{recipientStartDate:u,recipientEndDate:y+86399999}),delete t.recipientValue}if(t.completeValue&&t.completeValue.length){const[u,y]=t.completeValue;t=R(b({},t),{completeStartDate:u,completeEndDate:y+86399999}),delete t.completeValue}try{if(N(!0),f==="TODO"){const{data:u}=yield F(b({status:"TODO"},t));x.value=u}if(f==="DOING"){const{data:u}=yield F(b({status:"DOING",recipient:n.value.username},t));x.value=u}if(f==="DONE"){const{data:u}=yield F(b({status:"DONE",recipient:n.value.username},t));x.value=u}}catch(u){}finally{N(!1)}}),W=f=>{O(f),f==="TODO"&&(i.recipientValue=[],i.completeValue=[]),f==="DOING"&&(i.completeValue=[])};O(d.value);const L=f=>{m.push({path:"/dashboard/order",query:{id:f.id,isView:"true"}})},X=f=>S(this,null,function*(){yield se(f.id,{status:"DOING"}),O(d.value)}),z=f=>S(this,null,function*(){yield se(f.id,{status:"DONE"}),O(d.value)}),Z=()=>S(this,null,function*(){const f=d.value;let t="/api/order/export";if(f==="TODO"&&(t+="?status=TODO"),f==="DOING"&&(t+=`?status=DOING&recipient=${n.value.username}`),f==="DONE"&&(t+=`?status=DONE&recipient=${n.value.username}`),i.registrationValue&&i.registrationValue.length){const[u,y]=i.registrationValue;t+=`&startDate=${u}&endDate=${y+86399999}`}if(i.recipientValue&&i.recipientValue.length){const[u,y]=i.recipientValue;t+=`&recipientStartDate=${u}&recipientEndDate=${y+86399999}`}if(i.completeValue&&i.completeValue.length){const[u,y]=i.completeValue;t+=`&completeStartDate=${u}&completeEndDate=${y+86399999}`}window.open(t)}),Y=()=>{O(d.value)};return(f,t)=>{const u=fe,y=me,T=ce,B=ge,q=_e,_=De,j=pe,ee=ve,c=de,l=ue;return D(),k(l,{loading:$(v),style:{width:"100%"}},{default:a(()=>[e(c,{class:"general-card","header-style":{paddingBottom:"0"},"body-style":{padding:"17px 20px 21px 20px"}},{title:a(()=>t[4]||(t[4]=[s(" 订单认领 ")])),extra:a(()=>t[5]||(t[5]=[])),default:a(()=>[e(j,{direction:"vertical",size:10,fill:""},{default:a(()=>[e(T,{justify:"space-between"},{default:a(()=>[e(T,{align:"center"},{default:a(()=>[e(y,{"model-value":d.value,"onUpdate:modelValue":t[0]||(t[0]=o=>d.value=o),type:"button",onChange:W},{default:a(()=>[e(u,{value:"TODO"},{default:a(()=>t[6]||(t[6]=[s(" 待认领 ")])),_:1}),e(u,{value:"DOING"},{default:a(()=>t[7]||(t[7]=[s(" 我认领的 ")])),_:1}),e(u,{value:"DONE"},{default:a(()=>t[8]||(t[8]=[s(" 已完成 ")])),_:1})]),_:1},8,["model-value"])]),_:1}),e(T,{align:"center"},{default:a(()=>[e(B,{type:"primary",style:{"margin-left":"12px"},onClick:Z},{default:a(()=>t[9]||(t[9]=[s("导出")])),_:1})]),_:1})]),_:1}),e(T,{align:"center"},{default:a(()=>[t[12]||(t[12]=G("span",null,"登记日期：",-1)),e(q,{"allow-clear":"",modelValue:i.registrationValue,"onUpdate:modelValue":t[1]||(t[1]=o=>i.registrationValue=o),"value-format":"timestamp",onChange:Y,style:{width:"254px"}},null,8,["modelValue"]),d.value==="DOING"||d.value==="DONE"?(D(),P(H,{key:0},[t[10]||(t[10]=G("span",{style:{"margin-left":"24px"}},"认领日期：",-1)),e(q,{"allow-clear":"",modelValue:i.recipientValue,"onUpdate:modelValue":t[2]||(t[2]=o=>i.recipientValue=o),"value-format":"timestamp",onChange:Y,style:{width:"254px"}},null,8,["modelValue"])],64)):M("",!0),d.value==="DONE"?(D(),P(H,{key:1},[t[11]||(t[11]=G("span",{style:{"margin-left":"24px"}},"完成日期：",-1)),e(q,{"allow-clear":"",modelValue:i.completeValue,"onUpdate:modelValue":t[3]||(t[3]=o=>i.completeValue=o),"value-format":"timestamp",onChange:Y,style:{width:"254px"}},null,8,["modelValue"])],64)):M("",!0)]),_:1}),e(ee,{data:x.value,pagination:!0,bordered:!1,size:"small",scroll:{x:"140%"}},{columns:a(()=>[e(_,{ellipsis:"",tooltip:"",fixed:"left",title:"订单编号","data-index":"orderCode"}),e(_,{ellipsis:"",tooltip:"",title:"标题","data-index":"title"}),d.value==="TODO"?(D(),k(_,{key:0,ellipsis:"",tooltip:"",title:"登记日期","data-index":"registrationDate"},{cell:a(({record:o})=>[s(C($(E)(o.registrationDate).format("YYYY-MM-DD")),1)]),_:1})):M("",!0),d.value==="DONE"?(D(),k(_,{key:1,ellipsis:"",tooltip:"",title:"完成日期","data-index":"completeDate"},{cell:a(({record:o})=>[s(C(o.completeDate&&$(E)(o.completeDate).format("YYYY-MM-DD")),1)]),_:1})):M("",!0),d.value==="DOING"||d.value==="DONE"?(D(),k(_,{key:2,ellipsis:"",tooltip:"",title:"认领日期","data-index":"recipientDate"},{cell:a(({record:o})=>[s(C(o.recipientDate&&$(E)(o.recipientDate).format("YYYY-MM-DD")),1)]),_:1})):M("",!0),e(_,{ellipsis:"",tooltip:"",title:"客户名称","data-index":"customer"}),e(_,{ellipsis:"",tooltip:"",title:"办理国家","data-index":"country"}),e(_,{ellipsis:"",tooltip:"",title:"办理类型","data-index":"type"}),e(_,{ellipsis:"",tooltip:"",title:"签单金额","data-index":"orderMoney"}),e(_,{ellipsis:"",tooltip:"",title:"到账金额","data-index":"receivedMoney"}),e(_,{ellipsis:"",tooltip:"",title:"咨询老师","data-index":"creator"}),e(_,{ellipsis:"",tooltip:"",title:"办理状态","data-index":"status"},{cell:a(({record:o})=>[s(C($(Oe)(o.status)),1)]),_:1}),e(_,{ellipsis:"",tooltip:"",title:"操作费","data-index":"operateMoney"}),e(_,{ellipsis:"",tooltip:"",title:"登记月份","data-index":"registrationDate"},{cell:a(({record:o})=>[s(C($(E)(o.registrationDate).format("YYYY-MM")),1)]),_:1}),e(_,{ellipsis:"",tooltip:"",title:"备注","data-index":"comment"}),e(_,{title:"操作",width:"220",fixed:"right","data-index":"operator"},{cell:a(({record:o})=>[e(j,null,{default:a(()=>[e(B,{type:"text",onClick:U=>L(o)},{default:a(()=>t[13]||(t[13]=[s("查看")])),_:2},1032,["onClick"]),o.status==="TODO"?(D(),k(B,{key:0,type:"text",status:"danger",onClick:U=>X(o)},{default:a(()=>t[14]||(t[14]=[s("认领")])),_:2},1032,["onClick"])):M("",!0),o.status==="DOING"?(D(),k(B,{key:1,type:"text",status:"danger",onClick:U=>z(o)},{default:a(()=>t[15]||(t[15]=[s("完成")])),_:2},1032,["onClick"])):M("",!0)]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),Xe=Q(We,[["__scopeId","data-v-b81fa280"]]),Ze={class:"container"},et={class:"left-side"},tt={class:"panel"},at={name:"Dashboard"},lt=J(R(b({},at),{setup(g){const r=K(),n=h(()=>r.role);return(i,m)=>{const d=qe,v=ze;return D(),P("div",Ze,[G("div",et,[G("div",tt,[e(He)]),e(v,{cols:24,"col-gap":16,"row-gap":16,style:{"margin-top":"16px"}},{default:a(()=>[e(d,{span:24},{default:a(()=>[n.value==="saler"||n.value==="admin"||n.value==="leader"?(D(),k(Qe,{key:0})):M("",!0),n.value==="writer"||n.value==="admin"||n.value==="leader"?(D(),k(Xe,{key:1})):M("",!0)]),_:1})]),_:1})])])}}})),yt=Q(lt,[["__scopeId","data-v-3abdbcca"]]);export{yt as default};
