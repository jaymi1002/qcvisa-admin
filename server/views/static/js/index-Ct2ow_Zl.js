var Le=Object.defineProperty,Ue=Object.defineProperties;var Be=Object.getOwnPropertyDescriptors;var ie=Object.getOwnPropertySymbols;var Re=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable;var re=(_,d,o)=>d in _?Le(_,d,{enumerable:!0,configurable:!0,writable:!0,value:o}):_[d]=o,k=(_,d)=>{for(var o in d||(d={}))Re.call(d,o)&&re(_,o,d[o]);if(ie)for(var o of ie(d))ze.call(d,o)&&re(_,o,d[o]);return _},B=(_,d)=>Ue(_,Be(d));var S=(_,d,o)=>new Promise((n,p)=>{var m=v=>{try{I(o.next(v))}catch(V){p(V)}},O=v=>{try{I(o.throw(v))}catch(V){p(V)}},I=v=>v.done?n(v.value):Promise.resolve(v.value).then(m,O);I((o=o.apply(_,d)).next())});import{d as K,i as Q,c as R,f as b,o as y,w as l,aH as je,e as t,aB as Pe,x as s,t as Y,aI as qe,_ as X,k as ue,h as w,a as F,F as J,aJ as pe,s as C,aK as me,S as ce,aL as fe,aM as _e,aN as ye,B as ge,b as M,I as ve,aO as Ae,r as Fe,aP as De,aQ as xe,aR as Ve,aS as we,aT as We,a3 as N,aU as He,u as Oe,P as ke,M as Je,aV as Ke,aW as Qe,aX as Xe}from"./index-Bclkyy1-.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{g as A,d as Ze,c as he,u as de}from"./dashboard-CBtcHdF0.js";/* empty css              */import{h as G}from"./moment-DFa0WlA5.js";import{u as be}from"./loading-BepXu5w2.js";import{O as et}from"./order-GsG1fgm-.js";/* empty css              */const tt=K({__name:"banner",setup(_){const d=Q(),o=R(()=>({username:d.username}));return(n,p)=>{const m=Pe,O=je,I=qe;return y(),b(O,{class:"banner"},{default:l(()=>[t(O,{span:8},{default:l(()=>[t(m,{heading:5,style:{"margin-top":"0"}},{default:l(()=>[s(Y(n.$t("workplace.welcome"))+" "+Y(o.value.username),1)]),_:1})]),_:1}),t(I,{class:"panel-border"})]),_:1})}}}),at=X(tt,[["__scopeId","data-v-edf9fcb6"]]),Ce=_=>{switch(_){case"TODO":return"待处理";case"DOING":return"处理中";case"DONE":default:return"已完成"}},lt=[{value:"TODO",label:"待处理"},{value:"DOING",label:"处理中"},{value:"DONE",label:"已完成"}],ot=K({__name:"saler-order-list",setup(_){window.moment=G;const d=Q(),o=R(()=>({username:d.username})),n=R(()=>d.username),p=ue({status:"DOING",rangeValue:[],keyword:""}),m=Oe();ke();const O=w("MY"),{loading:I,setLoading:v}=be(),V=w(),Z=w(),L=w(!1),h=w(!0),z=w(),ee=w(lt),$=w(!1),i=()=>S(this,null,function*(){const c=O.value;let e=k({},p);if(e.rangeValue&&e.rangeValue.length){const[g,P]=e.rangeValue;e=B(k({},e),{startDate:g,endDate:P+86399999})}delete e.rangeValue,e.status||delete e.status,e.keyword||delete e.keyword;try{if(v(!0),c==="ALL"){const{data:g}=yield A(e);V.value=g}if(c==="MY"){const{data:g}=yield A(k({creator:o.value.username},e));V.value=g}}catch(g){}finally{v(!1)}}),a=()=>{i()};i();const u=()=>{i()},D=c=>{m.push({path:"/dashboard/order",query:{id:c.id,isView:"true"}})},U=c=>{m.push({path:"/dashboard/order",query:{id:c.id}})},T=c=>{Ze(c.id).then(()=>{i()})},te=()=>{Z.value={},L.value=!0,h.value=!1},j=()=>{const c=z.value.getFormData();he(c).then(()=>{Je.success("创建成功"),i()})},f=()=>S(this,null,function*(){var e;return!(yield(e=z.value)==null?void 0:e.validate())}),W=()=>{i()},H=(c,e)=>{i()},ae=()=>S(this,null,function*(){const c=O.value;let e="/api/order/export";if(c==="ALL"&&p.status&&(e+=`?status=${p.status}`),c==="MY"&&(e+=`?creator=${o.value.username}`,p.status&&(e+=`&status=${p.status}`)),p.rangeValue&&p.rangeValue.length){const[g,P]=p.rangeValue;e+=`&startDate=${g}&endDate=${P+86399999}`}if(p.keyword){const{keyword:g}=p;e+=`&keyword=${g}`}window.open(e)}),le=()=>{$.value=!0};return(c,e)=>{const g=ye,P=_e,q=fe,E=ge,Ne=ve,Ye=Ke,Ie=Ae,Me=De,x=Ve,$e=we,oe=ce,Se=xe,Te=me,Ee=pe,ne=We,Ge=He;return y(),F(J,null,[t(Ee,{loading:C(I),style:{width:"100%"}},{default:l(()=>[t(Te,{class:"general-card","header-style":{paddingBottom:"0px"},"body-style":{padding:"17px 20px 21px 20px"}},{title:l(()=>e[6]||(e[6]=[s(" 订单创建 ")])),extra:l(()=>e[7]||(e[7]=[])),default:l(()=>[t(oe,{direction:"vertical",size:10,fill:""},{default:l(()=>[t(q,{justify:"space-between"},{default:l(()=>[t(q,{align:"center"},{default:l(()=>[t(P,{"model-value":O.value,"onUpdate:modelValue":e[0]||(e[0]=r=>O.value=r),type:"button",onChange:a},{default:l(()=>[t(g,{value:"ALL"},{default:l(()=>e[8]||(e[8]=[s(" 全部 ")])),_:1}),t(g,{value:"MY"},{default:l(()=>e[9]||(e[9]=[s(" 我创建的 ")])),_:1})]),_:1},8,["model-value"])]),_:1}),t(q,{align:"center"},{default:l(()=>[t(E,{type:"primary",onClick:te},{default:l(()=>e[10]||(e[10]=[s("创建")])),_:1}),t(E,{style:{"margin-left":"12px"},onClick:ae},{default:l(()=>e[11]||(e[11]=[s("导出")])),_:1}),t(E,{style:{"margin-left":"12px"},onClick:le},{default:l(()=>e[12]||(e[12]=[s("导入")])),_:1})]),_:1})]),_:1}),t(q,{align:"center"},{default:l(()=>[e[14]||(e[14]=M("span",null,"关键字搜索：",-1)),t(Ne,{style:{width:"250px"},placeholder:"支持标题、客户、订单编码搜索",modelValue:p.keyword,"onUpdate:modelValue":e[1]||(e[1]=r=>p.keyword=r)},null,8,["modelValue"]),e[15]||(e[15]=M("span",{style:{"margin-left":"24px"}},"处理状态：",-1)),t(Ie,{placeholder:"全部",modelValue:p.status,"onUpdate:modelValue":e[2]||(e[2]=r=>p.status=r),style:{width:"100px"},"allow-clear":"",onChange:W},{default:l(()=>[(y(!0),F(J,null,Fe(ee.value,r=>(y(),b(Ye,{key:r.value,value:r.value},{default:l(()=>[s(Y(r.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),e[16]||(e[16]=M("span",{style:{"margin-left":"24px"}},"登记日期：",-1)),t(Me,{"allow-clear":"",modelValue:p.rangeValue,"onUpdate:modelValue":e[3]||(e[3]=r=>p.rangeValue=r),"value-format":"timestamp",onChange:H,style:{width:"254px"}},null,8,["modelValue"]),t(E,{style:{"margin-left":"24px"},type:"primary",onClick:u},{default:l(()=>e[13]||(e[13]=[s("搜索")])),_:1})]),_:1}),t(Se,{stripe:"",data:V.value,pagination:{"show-jumper":!0,"show-total":!0,"show-page-size":!0},bordered:!1,size:"small",scroll:{x:"140%"}},{columns:l(()=>[t(x,{ellipsis:"",tooltip:"",fixed:"left",width:"210",title:"订单编号","data-index":"orderCode"}),t(x,{ellipsis:"",tooltip:"",title:"标题","data-index":"title"}),t(x,{ellipsis:"",tooltip:"",title:"登记日期","data-index":"registrationDate"},{cell:l(({record:r})=>[s(Y(C(G)(r.registrationDate).format("YYYY-MM-DD")),1)]),_:1}),t(x,{ellipsis:"",tooltip:"",title:"客户名称","data-index":"customer"}),t(x,{ellipsis:"",tooltip:"",title:"办理国家","data-index":"country"}),t(x,{ellipsis:"",tooltip:"",title:"办理类型","data-index":"type"}),t(x,{ellipsis:"",tooltip:"",title:"签单金额","data-index":"orderMoney"}),t(x,{ellipsis:"",tooltip:"",title:"到账金额","data-index":"receivedMoney"}),t(x,{ellipsis:"",tooltip:"",title:"咨询老师","data-index":"creator"}),t(x,{ellipsis:"",tooltip:"",title:"办理状态","data-index":"status"},{cell:l(({record:r})=>[s(Y(C(Ce)(r.status)),1)]),_:1}),t(x,{ellipsis:"",tooltip:"",title:"文案老师","data-index":"recipient"}),t(x,{ellipsis:"",tooltip:"",title:"操作费","data-index":"operateMoney"}),t(x,{ellipsis:"",tooltip:"",title:"登记月份","data-index":"registrationDate"},{cell:l(({record:r})=>[s(Y(C(G)(r.registrationDate).format("YYYY-MM")),1)]),_:1}),t(x,{ellipsis:"",tooltip:"",title:"备注","data-index":"comment"}),t(x,{title:"操作",width:"220",fixed:"right","data-index":"operator"},{cell:l(({record:r})=>[t(oe,null,{default:l(()=>[t(E,{type:"text",onClick:se=>D(r)},{default:l(()=>e[17]||(e[17]=[s("查看")])),_:2},1032,["onClick"]),t(E,{disabled:n.value!==r.creator&&C(d).role!=="admin",type:"text",onClick:se=>U(r)},{default:l(()=>e[18]||(e[18]=[s("编辑")])),_:2},1032,["disabled","onClick"]),t($e,{content:"确定要删除吗？",onOk:se=>T(r)},{default:l(()=>[t(E,{disabled:n.value!==r.creator&&C(d).role!=="admin",type:"text",status:"danger"},{default:l(()=>e[19]||(e[19]=[s("删除")])),_:2},1032,["disabled"])]),_:2},1032,["onOk"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1},8,["loading"]),t(ne,{visible:L.value,"onUpdate:visible":e[4]||(e[4]=r=>L.value=r),onOk:j,onCancel:c.handleCancel,"on-before-ok":f,width:"1000px"},{title:l(()=>e[20]||(e[20]=[s(" 创建订单 ")])),default:l(()=>[L.value?(y(),b(et,{key:0,ref_key:"orderRef",ref:z,isView:!1,scene:"create"},null,512)):N("",!0)]),_:1},8,["visible","onCancel"]),t(ne,{visible:$.value,"onUpdate:visible":e[5]||(e[5]=r=>$.value=r),width:"1000px",onOk:i,onCancel:i},{title:l(()=>e[21]||(e[21]=[s(" 导入订单 ")])),default:l(()=>[t(q,{justify:"center"},{default:l(()=>[$.value?(y(),b(Ge,{key:0,action:"/api/order/import",name:"excel"})):N("",!0)]),_:1})]),_:1},8,["visible"])],64)}}}),nt=X(ot,[["__scopeId","data-v-7cbb69ef"]]),st=K({__name:"writer-order-list",setup(_){const d=Q(),o=R(()=>({username:d.username}));R(()=>d.username);const n=ue({registrationValue:[],recipientValue:[],completeValue:[],keyword:""}),p=Oe();ke();const m=w("DOING"),{loading:O,setLoading:I}=be(),v=w();w(),w(!1),w(!0),w();const V=()=>S(this,null,function*(){const i=m.value;let a=k({},n);if(a.registrationValue&&a.registrationValue.length){const[u,D]=a.registrationValue;a=B(k({},a),{startDate:u,endDate:D+86399999}),delete a.registrationValue}if(a.recipientValue&&a.recipientValue.length){const[u,D]=a.recipientValue;a=B(k({},a),{recipientStartDate:u,recipientEndDate:D+86399999}),delete a.recipientValue}if(a.completeValue&&a.completeValue.length){const[u,D]=a.completeValue;a=B(k({},a),{completeStartDate:u,completeEndDate:D+86399999}),delete a.completeValue}a.keyword||delete a.keyword;try{if(I(!0),i==="TODO"){const{data:u}=yield A(k({status:"TODO"},a));v.value=u}if(i==="DOING"){const{data:u}=yield A(k({status:"DOING",recipient:o.value.username},a));v.value=u}if(i==="DONE"){const{data:u}=yield A(k({status:"DONE",recipient:o.value.username},a));v.value=u}}catch(u){}finally{I(!1)}}),Z=i=>{V(),i==="TODO"&&(n.recipientValue=[],n.completeValue=[]),i==="DOING"&&(n.completeValue=[])};V();const L=i=>{p.push({path:"/dashboard/order",query:{id:i.id,isView:"true"}})},h=i=>S(this,null,function*(){yield de(i.id,{status:"DOING"}),V()}),z=i=>S(this,null,function*(){yield de(i.id,{status:"DONE"}),V()}),ee=()=>S(this,null,function*(){const i=m.value;let a="/api/order/export";if(i==="TODO"&&(a+="?status=TODO"),i==="DOING"&&(a+=`?status=DOING&recipient=${o.value.username}`),i==="DONE"&&(a+=`?status=DONE&recipient=${o.value.username}`),n.registrationValue&&n.registrationValue.length){const[u,D]=n.registrationValue;a+=`&startDate=${u}&endDate=${D+86399999}`}if(n.recipientValue&&n.recipientValue.length){const[u,D]=n.recipientValue;a+=`&recipientStartDate=${u}&recipientEndDate=${D+86399999}`}if(n.completeValue&&n.completeValue.length){const[u,D]=n.completeValue;a+=`&completeStartDate=${u}&completeEndDate=${D+86399999}`}if(n.keyword){const{keyword:u}=n;a+=`&keyword=${u}`}window.open(a)}),$=()=>{V()};return(i,a)=>{const u=ye,D=_e,U=fe,T=ge,te=ve,j=De,f=Ve,W=we,H=ce,ae=xe,le=me,c=pe;return y(),b(c,{loading:C(O),style:{width:"100%"}},{default:l(()=>[t(le,{class:"general-card","header-style":{paddingBottom:"0"},"body-style":{padding:"17px 20px 21px 20px"}},{title:l(()=>a[5]||(a[5]=[s(" 订单认领 ")])),extra:l(()=>a[6]||(a[6]=[])),default:l(()=>[t(H,{direction:"vertical",size:10,fill:""},{default:l(()=>[t(U,{justify:"space-between"},{default:l(()=>[t(U,{align:"center"},{default:l(()=>[t(D,{"model-value":m.value,"onUpdate:modelValue":a[0]||(a[0]=e=>m.value=e),type:"button",onChange:Z},{default:l(()=>[t(u,{value:"TODO"},{default:l(()=>a[7]||(a[7]=[s(" 待认领 ")])),_:1}),t(u,{value:"DOING"},{default:l(()=>a[8]||(a[8]=[s(" 我认领的 ")])),_:1}),t(u,{value:"DONE"},{default:l(()=>a[9]||(a[9]=[s(" 已完成 ")])),_:1})]),_:1},8,["model-value"])]),_:1}),t(U,{align:"center"},{default:l(()=>[t(T,{type:"primary",style:{"margin-left":"12px"},onClick:ee},{default:l(()=>a[10]||(a[10]=[s("导出")])),_:1})]),_:1})]),_:1}),t(U,{align:"center"},{default:l(()=>[a[14]||(a[14]=M("span",null,"关键字搜索：",-1)),t(te,{style:{width:"250px"},placeholder:"支持标题、客户、订单编码搜索",modelValue:n.keyword,"onUpdate:modelValue":a[1]||(a[1]=e=>n.keyword=e)},null,8,["modelValue"]),a[15]||(a[15]=M("span",{style:{"margin-left":"24px"}},"登记日期：",-1)),t(j,{"allow-clear":"",modelValue:n.registrationValue,"onUpdate:modelValue":a[2]||(a[2]=e=>n.registrationValue=e),"value-format":"timestamp",onChange:$,style:{width:"254px"}},null,8,["modelValue"]),m.value==="DOING"||m.value==="DONE"?(y(),F(J,{key:0},[a[11]||(a[11]=M("span",{style:{"margin-left":"24px"}},"认领日期：",-1)),t(j,{"allow-clear":"",modelValue:n.recipientValue,"onUpdate:modelValue":a[3]||(a[3]=e=>n.recipientValue=e),"value-format":"timestamp",onChange:$,style:{width:"254px"}},null,8,["modelValue"])],64)):N("",!0),m.value==="DONE"?(y(),F(J,{key:1},[a[12]||(a[12]=M("span",{style:{"margin-left":"24px"}},"完成日期：",-1)),t(j,{"allow-clear":"",modelValue:n.completeValue,"onUpdate:modelValue":a[4]||(a[4]=e=>n.completeValue=e),"value-format":"timestamp",onChange:$,style:{width:"254px"}},null,8,["modelValue"])],64)):N("",!0),t(T,{style:{"margin-left":"24px"},type:"primary",onClick:V},{default:l(()=>a[13]||(a[13]=[s("搜索")])),_:1})]),_:1}),t(ae,{stripe:"",pagination:{"show-jumper":!0,"show-page-size":!0},data:v.value,bordered:!1,size:"small",scroll:{x:"140%"}},{columns:l(()=>[t(f,{ellipsis:"",tooltip:"",fixed:"left",title:"订单编号","data-index":"orderCode"}),t(f,{ellipsis:"",tooltip:"",title:"标题","data-index":"title"}),m.value==="TODO"?(y(),b(f,{key:0,ellipsis:"",tooltip:"",title:"登记日期","data-index":"registrationDate"},{cell:l(({record:e})=>[s(Y(C(G)(e.registrationDate).format("YYYY-MM-DD")),1)]),_:1})):N("",!0),m.value==="DONE"?(y(),b(f,{key:1,ellipsis:"",tooltip:"",title:"完成日期","data-index":"completeDate"},{cell:l(({record:e})=>[s(Y(e.completeDate&&C(G)(e.completeDate).format("YYYY-MM-DD")),1)]),_:1})):N("",!0),m.value==="DOING"||m.value==="DONE"?(y(),b(f,{key:2,ellipsis:"",tooltip:"",title:"认领日期","data-index":"recipientDate"},{cell:l(({record:e})=>[s(Y(e.recipientDate&&C(G)(e.recipientDate).format("YYYY-MM-DD")),1)]),_:1})):N("",!0),t(f,{ellipsis:"",tooltip:"",title:"客户名称","data-index":"customer"}),t(f,{ellipsis:"",tooltip:"",title:"办理国家","data-index":"country"}),t(f,{ellipsis:"",tooltip:"",title:"办理类型","data-index":"type"}),t(f,{ellipsis:"",tooltip:"",title:"签单金额","data-index":"orderMoney"}),t(f,{ellipsis:"",tooltip:"",title:"到账金额","data-index":"receivedMoney"}),t(f,{ellipsis:"",tooltip:"",title:"咨询老师","data-index":"creator"}),t(f,{ellipsis:"",tooltip:"",title:"办理状态","data-index":"status"},{cell:l(({record:e})=>[s(Y(C(Ce)(e.status)),1)]),_:1}),t(f,{ellipsis:"",tooltip:"",title:"操作费","data-index":"operateMoney"}),t(f,{ellipsis:"",tooltip:"",title:"登记月份","data-index":"registrationDate"},{cell:l(({record:e})=>[s(Y(C(G)(e.registrationDate).format("YYYY-MM")),1)]),_:1}),t(f,{ellipsis:"",tooltip:"",title:"备注","data-index":"comment"}),t(f,{title:"操作",width:"220",fixed:"right","data-index":"operator"},{cell:l(({record:e})=>[t(H,null,{default:l(()=>[t(T,{type:"text",onClick:g=>L(e)},{default:l(()=>a[16]||(a[16]=[s("查看")])),_:2},1032,["onClick"]),e.status==="TODO"?(y(),b(W,{key:0,content:"确定要认领此单吗？",onOk:g=>h(e)},{default:l(()=>[t(T,{type:"text",status:"primary"},{default:l(()=>a[17]||(a[17]=[s("认领")])),_:1})]),_:2},1032,["onOk"])):N("",!0),e.status==="DOING"?(y(),b(W,{key:1,content:"确定要完成此单吗？",onOk:g=>z(e)},{default:l(()=>[t(T,{type:"text",status:"primary"},{default:l(()=>a[18]||(a[18]=[s("完成")])),_:1})]),_:2},1032,["onOk"])):N("",!0)]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})]),_:1},8,["loading"])}}}),it=X(st,[["__scopeId","data-v-ce65d354"]]),rt={class:"container"},dt={class:"left-side"},ut={class:"panel"},pt={name:"Dashboard"},mt=K(B(k({},pt),{setup(_){const d=Q(),o=R(()=>d.role);return(n,p)=>{const m=Xe,O=Qe;return y(),F("div",rt,[M("div",dt,[M("div",ut,[t(at)]),t(O,{cols:24,"col-gap":16,"row-gap":16,style:{"margin-top":"16px"}},{default:l(()=>[t(m,{span:24},{default:l(()=>[o.value==="saler"||o.value==="admin"||o.value==="leader"?(y(),b(nt,{key:0})):N("",!0),o.value==="writer"||o.value==="admin"||o.value==="leader"?(y(),b(it,{key:1})):N("",!0)]),_:1})]),_:1})])])}}})),It=X(mt,[["__scopeId","data-v-3abdbcca"]]);export{It as default};
